var mod=angular.module("rt.popup",[]);mod.factory("Popup",["$window","$document","$timeout","$compile",function(a,b,c,d){function e(a){$.contains(j[0],a.target)||f()}function f(){j&&c(function(){j.hide().remove(),b.off("click",e)})}function g(a,b,d,e,g){e||(e="right"),g||(g=""),d.popupView=a,d.hidePopover=f,c(function(){i(b,d,e,g)})}function h(c){var d=c[0].getBoundingClientRect();return{width:d.width||c.prop("offsetWidth"),height:d.height||c.prop("offsetHeight"),top:d.top+(a.pageYOffset||b[0].documentElement.scrollTop),left:d.left+(a.pageXOffset||b[0].documentElement.scrollLeft)}}function i(a,f,g,i){var k=null,o=null,p=null,q=d(l)(f);j=q;var r=h(a),s=b.find("body");s.append(q);var t=s.height()-2*m,u=$("<div />",{"class":"arrow"});q.children(".arrow").remove(),q.append(u),c(function(){if("right"===g)p={top:r.top+r.height/2,left:r.width-n},k={top:p.top-q.height()/2,left:p.left},k.top=Math.max(m,k.top),o={top:p.top-k.top};else if("left"===g)p={top:r.top+r.height/2,left:r.left+n-2},k={top:p.top-q.height()/2,left:p.left-q.width()},k.top=Math.max(m,k.top),o={top:p.top-k.top};else{if("bottom"!==g)throw new Error("Unsupported placement "+g);p={top:r.top+r.height,left:r.left+r.width/2},k={top:p.top-n,left:p.left-q.width()/2},k.left=Math.max(m,k.left),t-=k.top,o={left:p.left-k.left}}q.removeClass("left right bottom top"),q.addClass(g),i&&q.addClass(i),q.css({top:k.top+"px",left:k.left+"px",display:"block",maxHeight:t});var a=q.find(".popover-title"),c=q.find(".popover-content"),d=q.find(".popover-footer");c.css({maxHeight:t-d.outerHeight()-a.outerHeight()-4,overflow:"auto"}),o&&u.css(o),q.removeClass("hide"),b.on("click",e)})}var j=null,k={},l='<div class="popover"><div ng-include="popupView"></div></div>',m=10,n=5;return{register:function(a,b,c){a.addClass("popover hide"),k[b]={element:a,scope:c.$new()}},show:g,close:f}}]),mod.directive("popupShow",["Popup","$parse","$timeout",function(a,b,c){return{restrict:"A",scope:!0,link:function(d,e,f){e.click(function(){c(function(){a.close();var c=b(f.popupIf||"true");c(d)&&a.show(f.popupShow,e,d,f.popupPlacement,f.popupClass)})})}}}]);